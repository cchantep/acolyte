
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-09-24
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>acolyte - Acolyte Scalac plugin</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />


		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="stylesheet" type="text/css" href="css/pygments.min.css"/>
<link rel="stylesheet" type="text/css" href="css/responsive.css"/>
	</head>

	<body class="page-scalac-plugin project-acolyte" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">User guide <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="java.html" title="Java">Java</a></li>
									<li ><a href="scala.html" title="Scala">Scala</a></li>
									<li ><a href="faq.html" title="FAQ">FAQ</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Integration <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="integration.html" title="Guide">Guide</a></li>
									<li ><a href="integration.html#Play_Framework" title="Play Framework">Play Framework</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Subprojects <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="studio.html" title="Acolyte Studio">Acolyte Studio</a></li>
									<li class="active"><a href="" title="Scalac plugin">Scalac plugin</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
									<li ><a href="scaladocs/index.html" title="Scaladoc">Scaladoc</a></li>
									<li ><a href="build.html" title="Build">Build</a></li>
									<li ><a href="changelog.html" title="Changelog">Changelog</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial & Demo <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="http://tour.acolyte.eu.org" title="Interactive tour" class="externalLink">Interactive tour</a></li>
									<li ><a href="https://github.com/cchantep/acolyte/tree/10m-anorm-tutorial#acolyteanorm-10-minutes-tutorial" title="10m with Anorm" class="externalLink">10m with Anorm</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="https://groups.google.com/forum/#!forum/acolyte-support" title="Mailing list" class="externalLink">Mailing list</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="dropdown-submenu ">
										<a href="project-info.html" title="Project Information">Project Information</a>
										<ul class="dropdown-menu">
											<li ><a href="source-repository.html" title="Source Repository">Source Repository</a></li>
											<li ><a href="integration.html" title="Continuous Integration">Continuous Integration</a></li>
											<li ><a href="issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
		<div>
			<ul class="breadcrumb">
				<li class="projectVersion version-date">Version: 1.0.25</li>
				<li class="divider">|</li>
				<li class="publishDate version-date">Last Published: 2014-09-24</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1>Acolyte Scalac plugin</h1>
</div> 
<p>Scala compiler plugin</p> 
<div class="section"> 
 <h2 id="Match_component">Match component</h2> 
 <p>Scala pattern matching involves use of either case class or extractor.</p> 
 <p>When extractor needs parameters to be created, it should be declared as stable identifier before <tt>match</tt> block. e.g. With regular expression matching:</p> 
 <div> 
  <pre>val Letter = &quot;[a-zA-Z]+&quot;.r

&quot;String&quot; match {
  case Letter ⇒ true
}
</pre> 
 </div> 
 <p>Match component included in this plugin provides syntax <tt>~(extractorFactory[, bindings])</tt> for rich pattern matching.</p> 
 <p>Consider following extractor, instantiated with one parameter:</p> 
 <div> 
  <pre>case class Regex(e: String) {
  lazy val re = e.r
  def unapplySeq(target: Any): Option[List[String]] = re.unapplySeq(target)
}
</pre> 
 </div> 
 <p>Then provided rich syntax can be used as following (see <a href="./src/test/scala/acolyte/ExtractorComponentSpec.scala#L379">complete example</a>):</p> 
 <div> 
  <pre>str match {
  case ~(Regex(&quot;^a.*&quot;))                        ⇒ 1 // no binding

  case ~(Regex(&quot;# ([A-Z]+).*&quot;), a)             ⇒ 2 
  // if str == &quot;# BCD123&quot;, then a = &quot;BCD&quot;

  case ~(Regex(&quot;([0-9]+);([a-z]+)&quot;), (a, b))   ⇒ 3
  // if str == &quot;234;xyz&quot;, then a = &quot;234&quot; and b = &quot;xyz&quot;

  case str @ ~(IndexOf('/'), a :: b :: c :: _) ⇒ 4
  // if there are exactly 3 '/' in str, 
  // matches and assign indexes to a, b and c

  case ~(Regex(&quot;^cp (.+)&quot;), ~(Regex(&quot;([/a-z]+) ([/a-z]+)&quot;),
    (src @ ~(IndexOf('/'), a :: b :: Nil),
      dest @ ~(IndexOf('/'), c :: _))))        ⇒ 5
  // rich syntax can be used recursively

  case _                                       ⇒ 6
}
</pre> 
 </div> 
 <p>It will be refactored by plugin, so that required stable identifiers will be available for matching:</p> 
 <div> 
  <pre>val Xtr1 = Regex(&quot;^a.*&quot;)
// ...
str match {
  case Xtr1 ⇒ 1 // no binding
  // ...
}
</pre> 
 </div> 
 <blockquote> 
  <p>Syntax like <tt>(a, b)</tt> (where <tt>3</tt> is selected) doesn’t represent a tuple there, but multiple (list of) bindings.</p> 
 </blockquote> 
 <p>It also works with partial function (see <a href="./src/test/scala/acolyte/ExtractorComponentSpec.scala#L322">more examples</a>).</p> 
 <div> 
  <pre>val partialFun: String ⇒ Int = {
  case ~(Regex(&quot;^a.*&quot;))                      ⇒ 1
  case ~(Regex(&quot;# ([A-Z]+).*&quot;), a)           ⇒ 2 
  case ~(Regex(&quot;([0-9]+);([a-z]+)&quot;), (a, b)) ⇒ 3
  case _                                     ⇒ 4
}
// Or def partialFun: String =&gt; Int = ...
</pre> 
 </div> 
 <p>It will be refactored as:</p> 
 <div> 
  <pre>val partialFun: String ⇒ Int = { str: String ⇒
  val Xtr1 = Regex(&quot;^a.*&quot;)
  // ...
  str match {
    case Xtr1 ⇒ 1
    // ...
  }
}
</pre> 
 </div> 
 <p>Anonymous partial functions are refactored too (see <a href="./src/test/scala/acolyte/ExtractorComponentSpec.scala#L359">more examples</a>):</p> 
 <div> 
  <pre>def test(s: Option[String]): Option[Int] = s map {
  case ~(Regex(&quot;^a.*&quot;))                      ⇒ 1
  case ~(Regex(&quot;# ([A-Z]+).*&quot;), a)           ⇒ 2 
  case ~(Regex(&quot;([0-9]+);([a-z]+)&quot;), (a, b)) ⇒ 3
  case _                                     ⇒ 4
}
</pre> 
 </div> 
 <p>Pattern matching in <tt>val</tt> statement is enriched in the same way ((see <a href="./src/test/scala/acolyte/ExtractorComponentSpec.scala#L299">more examples</a>).</p> 
 <div> 
  <pre>val ~(Regex(&quot;([A-Z]+):([0-9]+)&quot;), (tag, priority)) = &quot;EN:456&quot;
// tag == &quot;EN&quot; &amp;&amp; priority == &quot;456&quot;
</pre> 
 </div> 
 <p>Such case is refactored as following:</p> 
 <div> 
  <pre>val Xtr1 = Regex(&quot;([A-Z]+):([0-9]+)&quot;)
val Xtr1(tag, priority) = &quot;FR:123&quot;
</pre> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Usage">Usage</h2> 
 <blockquote> 
  <p>If you have another <tt>~</tt> symbol, it will have to be renamed at <tt>import pkg.{ ~ ⇒ renamed }</tt>.</p> 
 </blockquote> 
 <div class="section"> 
  <h3 id="SBT_usage">SBT usage</h3> 
  <p>Scalac plugin can be used with SBT project, using its <a class="externalLink" href="http://www.scala-sbt.org/0.12.3/docs/Detailed-Topics/Compiler-Plugins.html">compiler plugins support</a>:</p> 
  <div> 
   <pre>autoCompilerPlugins := true

addCompilerPlugin(&quot;org.eu.acolyte&quot; %% &quot;scalac-plugin&quot; % &quot;VERSION&quot;)

scalacOptions += &quot;-P:acolyte:debug&quot; // Optional
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Maven_usage">Maven usage</h3> 
  <p>Maven scala plugin <a class="externalLink" href="http://scala-tools.org/mvnsites/maven-scala-plugin/example_scalac_plugins.html">supports compiler plugin</a>, so you can do:</p> 
  <div> 
   <pre>
<span class="nt">&lt;project</span><span class="nt">&gt;</span>
  <span class="c">&lt;!--</span><span class="c"> ... </span><span class="c">--&gt;</span>
  <span class="nt">&lt;build</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--</span><span class="c"> ... </span><span class="c">--&gt;</span>
    <span class="nt">&lt;plugings</span><span class="nt">&gt;</span>
      <span class="nt">&lt;plugin</span><span class="nt">&gt;</span>
        <span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.scala-tools<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>maven-scala-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="c">&lt;!--</span><span class="c"> ... version </span><span class="c">--&gt;</span>
        <span class="nt">&lt;configuration</span><span class="nt">&gt;</span>
          <span class="c">&lt;!--</span><span class="c"> ... </span><span class="c">--&gt;</span>
          <span class="nt">&lt;args</span><span class="nt">&gt;</span><span class="c">&lt;!--</span><span class="c"> Optional: enable debug </span><span class="c">--&gt;</span>
            <span class="nt">&lt;arg</span><span class="nt">&gt;</span>-P:acolyte:debug<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;/args&gt;</span>

          <span class="nt">&lt;compilerPlugins</span><span class="nt">&gt;</span>
            <span class="nt">&lt;compilerPlugin</span><span class="nt">&gt;</span>
              <span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.eu.acolyte<span class="nt">&lt;/groupId&gt;</span>
              <span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>scalac-plugin_2.10<span class="nt">&lt;/artifactId&gt;</span>
              <span class="nt">&lt;version</span><span class="nt">&gt;</span>VERSION<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;/compilerPlugin&gt;</span>
          <span class="nt">&lt;/compilerPlugins&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Plugin_options">Plugin options</h2> 
 <p>There is few option for this plugin.</p> 
 <ul> 
  <li><tt>-P:acolyte:debug</tt>: Display debug while compiling with (e.g. refactored match code).</li> 
 </ul> 
</div> 
<div class="section"> 
 <h2 id="Compilation_errors">Compilation errors</h2> 
 <p>As match component refactors <tt>match</tt> AST when <tt>~(…, …)</tt> is used, then if there is compilation error around that location will be mentioned as <tt>/path/to/file.scala#refactored-match-M</tt> (with <tt>M</tt> informational index of refactored match).</p> 
 <p>If there is an error with given extractor factory, you will get something like:</p> 
 <div> 
  <pre>[error] /path/to/file.scala#refactored-match-M:1: Compilation error.
[error] Error details.
[error] val Xtr1 = B() // generated from ln L, col C
</pre> 
 </div> 
 <p>Comment <tt>// generated from ln L, col C</tt> indicates location in original code, before it gets refactored.</p> 
 <p>If there result from given extractor factory is not a valid extract, it will raise:</p> 
 <div> 
  <pre>[error] /path/to/file.scala#refactored-match-M:1: value Xtr0 is not a case class constructor, nor does it have an unapply/unapplySeq method
[error] case Xtr1((a @ _)) =&gt; Nil // generated from ln L, col C
</pre> 
 </div> 
 <p>When using <tt>~(Xtractor(params))</tt>, following error can be raised if <tt>unapply</tt> from <tt>Xtractor</tt> wait at least one argument.</p> 
 <div> 
  <pre>[error] /path/to/file.scala#refactored-match-M:1: not enough patterns for class Clazz offering Xtractor: expected 1, found 0
</pre> 
 </div> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span9 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">User guide</li>
						<li >
							<a href="java.html" title="Java">Java</a>
						</li>
						<li >
							<a href="scala.html" title="Scala">Scala</a>
						</li>
						<li >
							<a href="faq.html" title="FAQ">FAQ</a>
						</li>
						<li class="nav-header">Integration</li>
						<li >
							<a href="integration.html" title="Guide">Guide</a>
						</li>
						<li >
							<a href="integration.html#Play_Framework" title="Play Framework">Play Framework</a>
						</li>
						<li class="nav-header">Subprojects</li>
						<li >
							<a href="studio.html" title="Acolyte Studio">Acolyte Studio</a>
						</li>
						<li class="active">
							<a href="#" title="Scalac plugin">Scalac plugin</a>
						</li>
						<li class="nav-header">Reference</li>
						<li >
							<a href="apidocs/index.html" title="Javadoc">Javadoc</a>
						</li>
						<li >
							<a href="scaladocs/index.html" title="Scaladoc">Scaladoc</a>
						</li>
						<li >
							<a href="build.html" title="Build">Build</a>
						</li>
						<li >
							<a href="changelog.html" title="Changelog">Changelog</a>
						</li>
						<li class="nav-header">Tutorial & Demo</li>
						<li >
							<a href="http://tour.acolyte.eu.org" title="Interactive tour" class="externalLink">Interactive tour</a>
						</li>
						<li >
							<a href="https://github.com/cchantep/acolyte/tree/10m-anorm-tutorial#acolyteanorm-10-minutes-tutorial" title="10m with Anorm" class="externalLink">10m with Anorm</a>
						</li>
						<li class="nav-header">Support</li>
						<li >
							<a href="https://groups.google.com/forum/#!forum/acolyte-support" title="Mailing list" class="externalLink">Mailing list</a>
						</li>
						<li class="nav-header">Project Documentation</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>
